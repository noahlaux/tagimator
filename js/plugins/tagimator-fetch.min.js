/**
 * Tagimator plugin - Fetch (http://github.com/noahlaux/tagimator)
 *
 * Makes tagimator able to fetch external pages with tagimator markup
 *
 * @version  1.0
 * @author Noah Laux (noahlaux@gmail.com)
 *
 * @dependency
 *  jQuery.tagimator (http://github.com/noahlaux/tagimator)
 */
(function(b){var e={renderSegments:function(a){var c=this;0<a.length&&(a.css({position:"relative",overflow:"hidden"}),a.each(function(a,d){b(d).find(".tagimator-fragment").each(function(a,b){c.renderFragment(b)})}))},renderFragment:function(a){var c=this,f=this.getGuid();b(a).attr("id","tagimator_"+f).addClass("fx-rendered");this.fetch(b(a).data("url"),function(d){b("head").find("style").append(c.parseCSS(d,f));b(a).append(c.parseHTML(d)).tagimator("show")})},fetch:function(a,c){b.ajax({url:a,success:function(a){c(a)},
error:function(b,d,e){c('<div class="tagimator-error"><p>can not render: '+a+"</p><p>reason: "+e+"</p></div>")}})},parseHTML:function(a){return a.replace(/<script.*?>[\s\S]*?<\/.*?script>/,"").replace(/<style.*?>[\s\S]*?<\/.?style>/,"")},parseCSS:function(a,b){return this.prefixCSS(a.match(/<style.*?>[\s\S]*?<\/.?style>/)[0].replace(/(<style>|<?<\/style>)/,""),"#tagimator_"+b)},prefixCSS:function(a,b){return a.replace(/(=|"|\[|\]|\:|[a-z0-9_\-]|#|\.)(([_a-zA-Z0-9]|=|\[|\]|\"|\:|\.)*(\s)*([_a-zA-Z0-9-]|\[|\=|\"|\]\:|\.|#)*)(?=[^}]+\{)/gi,
b+" $1$2")},getGuid:function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}};0<b(".tagimator-segment").not(".fx-rendered").length&&e.renderSegments(b(".tagimator-segment").not(".fx-rendered"))})(jQuery,this);