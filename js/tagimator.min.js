/**
 * jQuery tagimator (http://github.com/noahlaux/tagimator)
 *
 * @version 1.1
 *
 * @author Noah Laux (noahlaux@gmail.com)
 *
 * @dependency
 *  jquery
 *  jquery.effects.core.js
 */
(function(d){var c={init:function(a){c.settings=d.extend({speed:1E3,fx:"fade",easing:"easeInOutCubic",method:"show"},a);a&&(c.onBeforeStep=a.onBeforeStep?a.onBeforeStep:null,c.onAfterStep=a.onAfterStep?a.onAfterStep:null,c.onFinish=a.onFinish?a.onFinish:null);return this},show:function(){var a=d(this).filter("[data-fx]"),a=0===a.length?d(this).find("[data-fx]").not(".fxApplied"):a.not(".fxApplied"),e=c.createFxStack(a);d(a).not(".fxApplied").hide();c.parseSteps("show",e)},hide:function(){var a=d(this).filter(".fxApplied[data-fx]"),
a=0===a.length?d(this).find(".fxApplied"):a,a=c.reverseStack(c.createFxStack(a));c.parseSteps("hide",a)},reset:function(){d(this.children()).removeClass("fxApplied")},parseSteps:function(a,e){var f=d({});d.each(e,function(e,b){f.queue("transitions",function(f){if(c.onBeforeStep)c.onBeforeStep(e,b);d.when(c.transitions(b,a)).done(function(){if(c.onAfterStep)c.onAfterStep(e,b);f()}).fail(function(a,b){console.log(a,b)})})});f.queue("transitions",function(){if(c.onFinish)c.onFinish()});f.dequeue("transitions")},
transitions:function(a,c){var f=d.Deferred();d.each(a,function(g,b){if(!d.effects[b.fx])return f.reject('Effect "'+b.fx+'" does not exits. Did you include the jqeury.effect.'+b.fx+".js ? ",b),!1;b.el[c](b.fx,b.options,parseInt(b.speed,10),function(){"show"===c?b.el.addClass("fxApplied"):b.el.removeClass("fxApplied");if(b.outGoto){var h="self"===b.outGoto?b.el:d(b.outGoto);d.each(h,function(a,b){var c=d(b);c.is(":hidden")?d(c).tagimator("show"):d(c).tagimator("hide")})}g==a.length-1&&f.resolve(b)})});
return f.promise()},createFxStack:function(a){var e={};a.each(function(a,g){var b=d(g);e[b.attr("data-fx-step")]||(e[b.attr("data-fx-step")]=[]);e[b.attr("data-fx-step")].push({el:b,fx:b.attr("data-fx"),speed:b.attr("data-fx-speed")?b.attr("data-fx-speed"):c.settings.speed,outGoto:b.attr("data-fx-out-goto")?b.attr("data-fx-out-goto"):null,options:{direction:b.attr("data-fx-direction"),easing:b.attr("data-fx-easing")?b.attr("data-fx-easing"):c.settings.easing}})});return e},reverseStack:function(a){var c=
{},d,g=[];for(d in a)a.hasOwnProperty(d)&&g.push(d);g.reverse();var b=g.length;for(d=0;d<b;d++)c[d+1]=a[g[d]];return c}};d.fn.tagimator=function(a){if(c[a])return c.init.apply(this,Array.prototype.slice.call(arguments,1)),c[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return c.init.apply(this,arguments);d.error("Method "+a+" does not exist on jQuery.tagimator")}})(jQuery);